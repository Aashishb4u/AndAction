generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                      String     @id @default(cuid())
  email                   String?    @unique
  firstName               String?
  lastName                String?
  countryCode             String?
  phoneNumber             String?    @unique
  password                String?
  city                    String?
  state                   String?
  address                 String?
  zip                     String?
  role                    String     @default("user")
  isAccountVerified       Boolean    @default(false)
  isArtistVerified        Boolean    @default(false)
  gender                  String?
  dob                     DateTime?
  googleId                String?    @unique
  facebookId              String?    @unique
  appleId                 String?    @unique
  createdAt               DateTime   @default(now())
  updatedAt               DateTime   @updatedAt
  resetToken              String?
  resetTokenExpiry        DateTime?
  verificationToken       String?
  verificationTokenExpiry DateTime?
  avatar                  String?
  isDataSharingOptIn      Boolean    @default(false)
  isMarketingOptIn        Boolean    @default(false)
  artist                  Artist?
  bookings                Booking[]
  bookmarks               Bookmark[]
  videos                  Video[]

  @@index([email])
  @@index([phoneNumber])
  @@map("users")
}

model VerificationToken {
  id         String   @id @default(cuid())
  identifier String
  token      String   @unique
  expires    DateTime
  createdAt  DateTime @default(now())

  @@unique([identifier, token])
  @@index([identifier])
  @@map("verification_tokens")
}

model Artist {
  id                             String     @id @default(cuid())
  userId                         String     @unique
  stageName                      String?
  artistType                     String?
  subArtistType                  String?
  achievements                   String?
  yearsOfExperience              Int?
  shortBio                       String?
  performingLanguage             String?
  performingEventType            String?
  performingStates               String?
  performingDurationFrom         String?
  performingDurationTo           String?
  performingMembers              String?
  offStageMembers                String?
  contactNumber                  String?
  whatsappNumber                 String?
  contactEmail                   String?
  soloChargesFrom                Decimal?   @db.Decimal(10, 2)
  soloChargesTo                  Decimal?   @db.Decimal(10, 2)
  soloChargesDescription         String?
  chargesWithBacklineFrom        Decimal?   @db.Decimal(10, 2)
  chargesWithBacklineTo          Decimal?   @db.Decimal(10, 2)
  chargesWithBacklineDescription String?
  youtubeChannelId               String?
  instagramId                    String?
  createdAt                      DateTime   @default(now())
  updatedAt                      DateTime   @updatedAt
  user                           User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  bookingsReceived               Booking[]
  bookmarkedByUsers              Bookmark[]

  @@index([userId])
  @@index([artistType])
  @@map("artists")
}

model Video {
  id                String     @id @default(cuid())
  userId            String
  title             String
  description       String?
  url               String
  thumbnailUrl      String?
  duration          Int
  views             Int        @default(0)
  isApproved        Boolean    @default(false)
  createdAt         DateTime   @default(now())
  updatedAt         DateTime   @updatedAt
  bookmarkedByUsers Bookmark[]
  user              User       @relation(fields: [userId], references: [id])

  @@index([userId])
  @@index([isApproved])
  @@map("videos")
}

model Bookmark {
  id        String   @id @default(cuid())
  userId    String
  videoId   String?
  artistId  String?
  createdAt DateTime @default(now())
  artist    Artist?  @relation(fields: [artistId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id])
  video     Video?   @relation(fields: [videoId], references: [id], onDelete: Cascade)

  @@unique([userId, videoId])
  @@unique([userId, artistId])
  @@index([userId])
  @@map("bookmarks")
}

model Booking {
  id            String        @id @default(cuid())
  clientId      String
  artistId      String
  eventDate     DateTime
  eventType     String?
  eventLocation String?
  eventAddress  String?
  totalPrice    Decimal       @db.Decimal(10, 2)
  status        BookingStatus @default(PENDING)
  notes         String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  artist        Artist        @relation(fields: [artistId], references: [id])
  client        User          @relation(fields: [clientId], references: [id])

  @@index([clientId])
  @@index([artistId])
  @@index([status])
  @@map("bookings")
}

enum BookingStatus {
  PENDING
  APPROVED
  DECLINED
  CANCELLED
  COMPLETED
}
